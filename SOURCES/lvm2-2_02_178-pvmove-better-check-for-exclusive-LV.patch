From d21e2b6005f656c1600bb49942f585d001e94839 Mon Sep 17 00:00:00 2001
From: Zdenek Kabelac <zkabelac@redhat.com>
Date: Fri, 12 Jan 2018 15:59:07 +0100
Subject: [PATCH 15/25] pvmove: better check for exclusive LV

(cherry picked from commit 5a961d3411c8c11312d2998378277efc8988fc7f)
---
 tools/pvmove.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/tools/pvmove.c b/tools/pvmove.c
index 39cf25f..9bbe12b 100644
--- a/tools/pvmove.c
+++ b/tools/pvmove.c
@@ -451,7 +451,9 @@ static struct logical_volume *_set_up_pvmove_lv(struct cmd_context *cmd,
 		}
 
 		if (vg_is_clustered(vg) &&
-		    lv_is_active_exclusive_remotely(lv)) {
+		    lv_is_visible(lv) &&
+		    lv_is_active(lv) &&
+		    !lv_is_active_exclusive_locally(lv)) {
 			lv_skipped = 1;
 			log_print_unless_silent("Skipping LV %s which is activated "
 						"exclusively on remote node.", lv->name);
-- 
1.8.3.1

