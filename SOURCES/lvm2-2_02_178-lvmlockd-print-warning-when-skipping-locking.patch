From 599ec3dafea034dfafe0d897a8d591f0d07bd016 Mon Sep 17 00:00:00 2001
From: David Teigland <teigland@redhat.com>
Date: Tue, 9 Jan 2018 11:46:00 -0600
Subject: [PATCH 10/25] lvmlockd: print warning when skipping locking

(cherry picked from commit 51340888aab5e1b8630c7d8083e621ca0f4e4264)
---
 tools/lvmcmdline.c | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

diff --git a/tools/lvmcmdline.c b/tools/lvmcmdline.c
index 791e272..6be4bcd 100644
--- a/tools/lvmcmdline.c
+++ b/tools/lvmcmdline.c
@@ -2684,12 +2684,18 @@ static int _init_lvmlockd(struct cmd_context *cmd)
 
 	if (use_lvmlockd && arg_is_set(cmd, lockopt_ARG)) {
 		const char *opts = arg_str_value(cmd, lockopt_ARG, "");
-		if (strstr(opts, "skiplv"))
+		if (strstr(opts, "skiplv")) {
+			log_warn("WARNING: skipping LV lock in lvmlockd.");
 			cmd->lockd_lv_disable = 1;
-		if (strstr(opts, "skipvg"))
+		}
+		if (strstr(opts, "skipvg")) {
+			log_warn("WARNING: skipping VG lock in lvmlockd.");
 			cmd->lockd_vg_disable = 1;
-		if (strstr(opts, "skipgl"))
+		}
+		if (strstr(opts, "skipgl")) {
+			log_warn("WARNING: skipping global lock in lvmlockd.");
 			cmd->lockd_gl_disable = 1;
+		}
 	}
 
 	if (use_lvmlockd && locking_is_clustered()) {
-- 
1.8.3.1

